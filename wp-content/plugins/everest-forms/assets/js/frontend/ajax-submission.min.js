jQuery(function(c){"use strict";c('form[data-ajax_submission="1"]').each(function(e,s){c(document).ready(function(){var d=c(s),f=d.find(".evf-submit");0<d.find("[data-gateway*='stripe']:visible").length||f.on("click",function(e){var s=d.serializeArray();e.preventDefault(),d.trigger("focusout").trigger("change").trigger("submit");var r=d.find(".evf-error:visible");0<r.length?c([document.documentElement,document.body]).animate({scrollTop:r.last().offset().top},800):(c(this).html(d.data("process-text")),s.push({name:"action",value:"everest_forms_ajax_form_submission"}),s.push({name:"security",value:everest_forms_ajax_submission_params.evf_ajax_submission}),c.ajax({url:everest_forms_ajax_submission_params.ajax_url,type:"POST",data:s}).done(function(e,s,r){var i,t,a,o,n=e.data&&e.data.redirect_url?e.data.redirect_url:"";if(n)return d.trigger("reset"),void(window.location=n);"success"===e.data.response||!0===e.success?(d.trigger("reset"),d.closest(".everest-forms").html('<div class="everest-forms-notice everest-forms-notice--success" role="alert">'+e.data.message+"</div>").focus()):(i=d.data("formid"),t=everest_forms_ajax_submission_params.error,o=(a=JSON.parse(r.responseText)).data.error,"string"==typeof a.data.message&&(t=a.data.message),d.closest(".everest-forms").find(".everest-forms-notice").remove(),d.closest(".everest-forms").prepend('<div class="everest-forms-notice everest-forms-notice--error" role="alert">'+t+"</div>").focus(),c(o).each(function(e,s){var t,a=Object.values(s)[0],r=!0;switch(Object.keys(s)[0]){case"signature":t=c("#"+("evf-signature-img-input-"+a));break;case"likert":r=!1,(t=c('[id^="'+("everest_forms-"+i+"-field_"+a+"_")+'"]')).each(function(e,s){var r=c(s).closest("tr.evf-"+i+"-field_"+a).find("th"),t="everest_forms[form_fields]["+a+"]["+(parseInt(r.closest("tr").index())+1)+"]";r.children().is("label")?r.children().find("#"+t).show():r.append('<label id="'+t+'" for="'+t+'" class="evf-error">'+everest_forms_ajax_submission_params.required+"</label>")});break;case"address":(t=c('[id^="'+("evf-"+i+"-field_"+a)+'"]')).each(function(e,s){var r=String(c(s).attr("id"));(r.includes("-container")||r.includes("-address2")||void 0!==c(s).val())&&t.splice(e,1)});break;default:t=c("#"+("evf-"+i+"-field_"+a))}t.addClass("evf-error"),t.attr("required",!0),t.attr("aria-invalid",!0),t.first().closest(".evf-field").addClass("everest-forms-invalid evf-has-error"),!0!==r||t.is("label")||t.after('<label id="'+t.attr("id")+'-error" class="evf-error" for="'+t.attr("id")+'">'+everest_forms_ajax_submission_params.required+"</label>").show()}),f.attr("disabled",!1).html(everest_forms_ajax_submission_params.submit))}).fail(function(){f.attr("disabled",!1).html(everest_forms_ajax_submission_params.submit),d.trigger("focusout").trigger("change"),d.closest(".everest-forms").find(".everest-forms-notice").remove(),d.closest(".everest-forms").prepend('<div class="everest-forms-notice everest-forms-notice--error" role="alert">'+everest_forms_ajax_submission_params.error+"</div>").focus()}).always(function(e){!(e.data&&e.data.redirect_url?e.data.redirect_url:"")&&c(".everest-forms-notice").length&&c([document.documentElement,document.body]).animate({scrollTop:c(".everest-forms-notice").offset().top},800)}))})})})});